{% extends "layout/base.html.twig" %}
{% block content %}

{%  set isEdit = isEdit ?? false %}

<!-- Main Content -->
<main class="flex-1 overflow-auto flex justify-center">
    <div class="w-full p-8 max-w-3xl">

        <!-- Header -->
        <div class="flex items-center gap-4 mb-8">
            <button onclick="history.back()" class="text-gray-600 hover:text-gray-800">
                <span class="material-icons">arrow_back</span>
            </button>
            <div>
                <h2 class="text-3xl font-bold text-gray-800">{{ isEdit ? 'Editar Horário' : 'Novo Horário' }}</h2>
                <p class="text-gray-600 text-sm mt-1">Configure sua disponibilidade semanal</p>
            </div>
        </div>

        <!-- Form -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-10">
            <form 
                method="POST"
                action="{{ isEdit ? '/availabilities/' ~ availability.id : '/availabilities' }}"
            >
                {% if isEdit %}
                    <input type="hidden" name="_method" value="PUT">
                {% endif %}
                <!-- Dia da Semana -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Dia da Semana *
                    </label>
                    <select name="weekday" required class="w-full border rounded-lg px-4 py-3">
                        {% for key, label in {
                            0:'Domingo',1:'Segunda-feira',2:'Terça-feira',3:'Quarta-feira',
                            4:'Quinta-feira',5:'Sexta-feira',6:'Sábado'
                        } %}
                            <option value="{{ key }}"
                                {{ availability.weekday is defined and availability.weekday == key ? 'selected' : '' }}>
                                {{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Horários -->
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Horário de Início *
                        </label>
                        <input
                            type="time"
                            name="start_time"
                            required
                            value="{{ availability.start_time|default('') }}"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-sky-500 focus:ring-2 focus:ring-sky-500/20"
                        >
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Horário de Fim *
                        </label>
                        <input
                            type="time"
                            name="end_time"
                            required
                            value="{{ availability.end_time|default('') }}"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-sky-500 focus:ring-2 focus:ring-sky-500/20"
                        >
                    </div>
                </div>

                <!-- Duração -->
                <div class="mb-8">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Duração do Atendimento (minutos) *
                    </label>
                    <select name="slot_duration" required class="w-full border rounded-lg px-4 py-3">
                        {% for minutes in [15,30,45,60] %}
                            <option value="{{ minutes }}"
                                {{ availability.slot_duration is defined and availability.slot_duration == minutes ? 'selected' : '' }}>
                                {{ minutes }} minutos
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Buttons -->
                <div class="flex gap-4">
                    <a
                        href="/availabilities"
                        class="flex-1 text-center bg-gray-100 text-gray-700 px-6 py-3 rounded-lg font-medium hover:bg-gray-200"
                    >
                        Cancelar
                    </a>

                    <button
                        type="submit"
                        class="flex-1 bg-sky-500 hover:bg-sky-700 text-white px-6 py-3 rounded-lg font-medium"
                    >
                        {{ isEdit ? 'Atualizar' : 'Salvar' }}
                    </button>
                </div>

            </form>
        </div>
    </div>
</main>

{% endblock %}